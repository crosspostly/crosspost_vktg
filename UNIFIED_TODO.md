# üìã Unified TODO ‚Äî VK‚ÜíTelegram Crossposter (Server + Client + Fixes + Code Samples)

–û–±–Ω–æ–≤–ª–µ–Ω–æ: 2025-11-02
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ï–î–ò–ù–´–ô —Ñ–∞–π–ª –∑–∞–¥–∞—á. –í—Å–µ –ø—Ä–æ—á–∏–µ todo/readme/to_fix ‚Äî —É–¥–∞–ª–∏—Ç—å. –†–∞–±–æ—á–∞—è –∏—Å—Ç–∏–Ω–∞ –∑–¥–µ—Å—å.

---

## üîß SERVER (server.gs)

### A. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ (–æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∫ —Å–ª–æ–∂–Ω–æ–º—É)
1) API-–æ–±—ë—Ä—Ç–∫–∞ –∏ JSON –ø–∞—Ä—Å–µ—Ä
- [ ] makeApiRequest(service, url, options)
- [ ] parseJsonSafe(text)
- –í–Ω–µ–¥—Ä–∏—Ç—å –≤: Telegram sendMessage/sendMediaGroup –∏ VK wall.get/video.get

2) –í–∞–ª–∏–¥–∞—Ü–∏—è payload/–ª–∏—Ü–µ–Ω–∑–∏–∏/–æ—Ç–≤–µ—Ç–æ–≤
- [ ] validatePayload(payload, requiredFields)
- [ ] validateLicenseOrThrow(licenseKey)
- [ ] success(data, meta?) / fail(message, code?, meta?) + jsonResponse

3) Caption split —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ
- [ ] ensureCaptionOrSplit(token, chatId, mediaUrls, caption)
- –°–æ–∫—Ä–∞—Ç–∏—Ç—å sendVkPostToTelegram, —É–±—Ä–∞—Ç—å –¥—É–±–ª–∏

4) –£—Ç–∏–ª–∏—Ç—ã Sheets (–º–∏–Ω–∏–º—É–º)
- [ ] getRows(name), findRow(name, predicate), appendRow(name, obj)

5) –í—ã–Ω–µ—Å—Ç–∏ —É—Ç–∏–ª–∏—Ç—ã –≤ —Ñ–∞–π–ª—ã (–ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏)
- api-utils.gs, validation-utils.gs, sheets-utils.gs, html-builder.gs, config-manager.gs

### B. –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏/–º–µ–¥–∏–∞
6) –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ –±–µ–∑ ¬´—Ç–µ—Å—Ç–∞¬ª
- [ ] –ï—Å–ª–∏ vk_post –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω –≤ handleSendPost ‚Äî —Å–µ—Ä–≤–µ—Ä —Å–∞–º –±–µ—Ä—ë—Ç 1 –∏–ª–∏ N –Ω–µ–ø—Ä–∏–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤ –∏–∑ VK –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å–≤—è–∑–∫–∏

7) –ú–µ–¥–∏–∞-–≥—Ä—É–ø–ø—ã —Å—Ç—Ä–æ–≥–æ –æ–¥–Ω–æ–π –ø–∞—á–∫–æ–π
- [ ] –°–æ–±—Ä–∞—Ç—å —Ñ–æ—Ç–æ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ ‚Üí –æ–¥–∏–Ω sendMediaGroup (–¥–æ 10)
- [ ] –í–∏–¥–µ–æ/–∞—É–¥–∏–æ/–¥–æ–∫–∏ ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º (—Å–ø–∏—Å–æ–∫ —Å—Å—ã–ª–æ–∫)

### C. –°—Å—ã–ª–∫–∏ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
8) VK ‚Üí Telegram Markdown —Å—Å—ã–ª–∫–∏ (–ù–ï —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ—Å—Ç)
- [ ] [screen_name|Title] ‚Üí [Title](https://vk.com/screen_name)
- [ ] [club/public/id123|Title] –ø–æ–¥–¥–µ—Ä–∂–∞–Ω—ã
- [ ] [https://example.com|–¢–µ–∫—Å—Ç] ‚Üí [–¢–µ–∫—Å—Ç](https://example.com)
- [ ] vk.com/wall-‚Ä¶ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏–Ω–∫, –Ω–æ –Ω–µ –ø–æ–¥–º–µ–Ω—è–µ—Ç Title-—Å—Å—ã–ª–∫–∏
- [ ] vk.cc/‚Ä¶ –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–∞–∫ –µ—Å—Ç—å (–≤–Ω–µ—à–Ω–∏–π —Å–∞–π—Ç –≤–æ–∑–º–æ–∂–µ–Ω)
- [ ] –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã Markdown –≤ Title
- –¢–µ—Å—Ç-–∫–µ–π—Å—ã ‚Äî —Å–º. –Ω–∏–∂–µ

9) –û–ø—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ —Ñ–ª–∞–≥–∞–º
- [ ] –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –∂–∏—Ä–Ω—ã–º (on/off)
- [ ] –°–ª–æ–≤–∞ –í–ï–†–•–ù–ò–ú –†–ï–ì–ò–°–¢–†–û–ú ‚Äî –∂–∏—Ä–Ω—ã–º (on/off)

10) –ù–∞–∑–≤–∞–Ω–∏—è VK/TG ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤—ã–¥–∞—á–∞ –∏ –∫–µ—à
- [ ] getVkGroupName/getTelegramChatName + –∫–µ—à
- [ ] –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

11) Enhanced Error Logging
- [ ] logApiCall (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ VK_API/TG_API/SYSTEM/USER, http-status, body)
- [ ] –ê–≤—Ç–æ-—Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤

12) Comprehensive Error Handling
- [ ] retryApiCall(backoff)
- [ ] –°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

---

## üñ•Ô∏è CLIENT (client.gs)

1) ¬´–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ—Å—Ç¬ª –≤–º–µ—Å—Ç–æ ¬´–¢–µ—Å—Ç¬ª
- [ ] UI: –∑–∞–º–µ–Ω–∏—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∞ ¬´‚ñ∂Ô∏è –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ—Å—Ç¬ª
- [ ] –í—ã–∑–æ–≤ event "send_post" –±–µ–∑ vk_post ‚Üí —Å–µ—Ä–≤–µ—Ä –ø—É–±–ª–∏–∫—É–µ—Ç –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

2) –ü–µ—Ä–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: 1 –∏–ª–∏ N –ø–æ—Å—Ç–æ–≤
- [ ] –í –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å–≤—è–∑–∫–∏: —á–µ–∫–±–æ–∫—Å ¬´–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ—Å—Ç—ã¬ª, –ø–æ–ª–µ N (1..50)
- [ ] –°–æ—Ö—Ä–∞–Ω—è—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Bindings: sync_recent_enabled, sync_recent_count)
- [ ] –í –¥–∞–ª—å–Ω–µ–π—à–µ–º ‚Äî —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã ( > lastKnownId)

3) Published-–ª–∏—Å—Ç—ã –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –≥—Ä—É–ø–ø—ã
- [ ] –ò–º—è –ª–∏—Å—Ç–∞: Published_<vkGroupName> (–±–µ–∑ –æ–ø–∞—Å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤)
- [ ] –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî –º–∏–≥—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –ª–∏—Å—Ç–æ–≤
- [ ] –®–∞–ø–∫–∞: Post ID | Sent At | TG Chat ID | Status | Source
- [ ] –í–º–µ—Å—Ç–æ TG Chat ID –≤—ã–≤–æ–¥–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞/–∫–∞–Ω–∞–ª–∞ (tgChatName) –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É ¬´Post Preview¬ª ‚Äî –ø–µ—Ä–≤—ã–µ 150‚Äì300 —Å–∏–º–≤–æ–ª–æ–≤ —Ç–µ–∫—Å—Ç–∞ –ø–æ—Å—Ç–∞ (–±–µ–∑ –º–µ–¥–∏–∞)
- [ ] –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏: DD.MM.YYYY, HH:mm (–ª–æ–∫–∞–ª—å RU)

4) –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –æ–ø—Ü–∏–∏ –≤ —Å–≤—è–∑–∫–µ
- [ ] –ß–µ–∫–±–æ–∫—Å—ã: ¬´–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –∂–∏—Ä–Ω—ã–º¬ª, ¬´–í–°–ï –ó–ê–ì–õ–ê–í–ù–´–ï ‚Äî –∂–∏—Ä–Ω—ã–º¬ª
- [ ] –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ñ–ª–∞–≥–∏ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

5) –ú–∞—Å—Å–æ–≤—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
- [ ] –í—ã–∫–ª—é—á–∏—Ç—å/–≤–∫–ª—é—á–∏—Ç—å –≤—Å–µ —Å–≤—è–∑–∫–∏ (–∫–Ω–æ–ø–∫–∞ –≤ UI)
- [ ] (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) —Å–µ—Ä–≤–µ—Ä–Ω—ã–π endpoint toggle_all_bindings

6) –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π ScriptApp (–±–µ–∑ appsscript.json)
- [ ] –ö–Ω–æ–ø–∫–∞ ¬´–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (ScriptApp)¬ª
- [ ] doFirstAuth(): ScriptApp.getProjectTriggers()
- [ ] –ú–æ–¥–∞–ª–∫–∞: ¬´–û—Ç–∫—Ä–æ–π—Ç–µ Apps Script ‚Üí –≤—ã–ø–æ–ª–Ω–∏—Ç–µ doFirstAuth ‚Üí —Ä–∞–∑—Ä–µ—à–∏—Ç–µ ‚Üí –≤–µ—Ä–Ω–∏—Ç–µ—Å—å ‚Üí –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É¬ª
- [ ] trySetupTrigger(): –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–µ

7) UI –∏–º—ë–Ω –∏ —Å—Ç–∞—Ç—É—Å–æ–≤
- [ ] –í –∫–∞—Ä—Ç–æ—á–∫–µ —Å–≤—è–∑–∫–∏ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–º–µ–Ω–∞ VK/TG, URL/chat_id ‚Äî –ø–æ–¥ –ø–æ–¥—Å–∫–∞–∑–∫–æ–π
- [ ] Warnings, –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω—ã –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã/–±–æ—Ç –Ω–µ –≤ —á–∞—Ç–µ

---

## üß© LINK CONVERSION ‚Äî –ü—Ä–∞–≤–∏–ª–∞ –∏ —Ç–µ—Å—Ç-–∫–µ–π—Å—ã (Server)

–ü—Ä–∞–≤–∏–ª–∞:
- [screen_name|Title] ‚Üí [Title](https://vk.com/screen_name)
- [club123456|–ù–∞–∑–≤–∞–Ω–∏–µ]/[public123456|–ù–∞–∑–≤–∞–Ω–∏–µ]/[id123456|–ò–º—è] –ø–æ–¥–¥–µ—Ä–∂–∞–Ω—ã
- [https://example.com|–¢–µ–∫—Å—Ç] ‚Üí [–¢–µ–∫—Å—Ç](https://example.com)
- vk.com/wall-<id>_<postId> ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏–Ω–∫ (–Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç Title)
- vk.cc/short ‚Äî –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–∞–∫ –µ—Å—Ç—å (–º–æ–∂–µ—Ç –≤–µ—Å—Ç–∏ –Ω–∞ –≤–Ω–µ—à–Ω–∏–π —Å–∞–π—Ç)
- –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã Markdown –≤ Title

–¢–µ—Å—Ç—ã:
- [durov|–ü–∞–≤–µ–ª –î—É—Ä–æ–≤] ‚Üí [–ü–∞–≤–µ–ª –î—É—Ä–æ–≤](https://vk.com/durov)
- [club123456|VK Dev] ‚Üí [VK Dev](https://vk.com/club123456)
- [daoqub|@daoqub] ‚Üí [@daoqub](https://vk.com/daoqub)
- [durov|–ü–∞–≤–µ–ª –î—É—Ä–æ–≤ (VK)] ‚Üí [–ü–∞–≤–µ–ª –î—É—Ä–æ–≤ (VK)](https://vk.com/durov)
- https://vk.com/wall-123_456 ‚Üí [–ü–æ—Å—Ç VK](https://vk.com/wall-123_456)
- [https://example.com|–°–∞–π—Ç] ‚Üí [–°–∞–π—Ç](https://example.com)

---

## üõ†Ô∏è CODE SAMPLES (Cheat)

// Regex –¥–ª—è VK-–≥–∏–ø–µ—Ä—Å—Å—ã–ª–æ–∫ –≤–Ω—É—Ç—Ä–∏ []
// const rx = /\[([^\]|]+)\|([^\]]+)\]/g; // screen_name | Title
// text.replace(rx, (m, screen, title) => `[${title}](https://vk.com/${screen})`)

// –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –º–µ–¥–∏–∞–≥—Ä—É–ø–ø—ã —Å caption split
// if (caption && caption.length > 1024) {
//   sendMediaGroupWithoutCaption(token, chatId, mediaUrls);
//   sendLongTextMessage(token, chatId, caption);
// } else {
//   sendMediaGroupWithCaption(token, chatId, mediaUrls, caption);
// }

// –ü–µ—Ä–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è N –ø–æ—Å—Ç–æ–≤
// const count = sync_recent_enabled ? Math.min(sync_recent_count, 50) : 1;

---

## üßπ –ß–∏—Å—Ç–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- –£–¥–∞–ª–∏—Ç—å: –≤—Å–µ —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã–µ TODO/README –≤ to_fix, todo_server.gs, todo_clients.gs, todo_clients_permissions.gs, vk_link_markdown_todo.txt (–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã —Å—é–¥–∞)
- –ò—Å—Ç–∏–Ω–∞ ‚Äî —ç—Ç–æ—Ç –µ–¥–∏–Ω—ã–π —Ñ–∞–π–ª: Unified TODO (–∫–æ—Ä–µ–Ω—å)
