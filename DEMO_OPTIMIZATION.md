# üöÄ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø: MediaGroup Optimization

## ‚úÖ –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞!

### üìç –ì–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–∏:

**1. –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```javascript
// server.gs, —Å—Ç—Ä–æ–∫–∏ 4039-4150
function sendMixedMediaOptimized(botToken, chatId, mediaUrls, caption, options)
```

**2. –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è:**
```javascript
// server.gs, —Å—Ç—Ä–æ–∫–∏ 4155-4191  
function sendTelegramDocument(botToken, chatId, documentUrl, caption)
```

**3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É:**
```javascript
// server.gs, —Å—Ç—Ä–æ–∫–∏ 1545-1570
// –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è sendVkPostToTelegram()
```

**4. –¢–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è:**
```javascript
// server.gs, —Å—Ç—Ä–æ–∫–∏ 4198-4298
function testSendMixedMediaOptimized()
```

## üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### –î–û –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò:
```
10 —Ñ–æ—Ç–æ = 10 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Telegram
–í—Ä–µ–º—è: ~10 —Å–µ–∫—É–Ω–¥
–ù–∞–≥—Ä—É–∑–∫–∞: –í—ã—Å–æ–∫–∞—è
```

### –ü–û–°–õ–ï –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò:
```
10 —Ñ–æ—Ç–æ = 1 API –∑–∞–ø—Ä–æ—Å (MediaGroup –∏–∑ 10 —Ñ–æ—Ç–æ)
–í—Ä–µ–º—è: ~1 —Å–µ–∫—É–Ω–¥–∞  
–ù–∞–≥—Ä—É–∑–∫–∞: –ù–∏–∑–∫–∞—è
–≠–∫–æ–Ω–æ–º–∏—è: 90% API –∑–∞–ø—Ä–æ—Å–æ–≤!
```

## üìã –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```javascript
// –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ sendVkPostToTelegram()
var result = sendMixedMediaOptimized(
  botToken,           // Telegram Bot Token
  chatId,             // ID —á–∞—Ç–∞/–∫–∞–Ω–∞–ª–∞
  mediaUrls,          // [{type: 'photo', url: '...'}, ...]
  "–¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞",     // Caption –¥–ª—è –ø–µ—Ä–≤–æ–π –≥—Ä—É–ø–ø—ã
  {parse_mode: 'HTML'} // –û–ø—Ü–∏–∏
);

// –†–µ–∑—É–ª—å—Ç–∞—Ç:
// {
//   success: true,
//   message_id: 12345,
//   optimization_stats: {
//     api_calls_saved: 9,    // –°—ç–∫–æ–Ω–æ–º–ª–µ–Ω–æ API –∑–∞–ø—Ä–æ—Å–æ–≤
//     photo_groups: 1        // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ MediaGroup
//   }
// }
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é:
```javascript
testSendMixedMediaOptimized()
```

**–¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç:**
1. ‚úÖ 5 —Ñ–æ—Ç–æ ‚Üí 1 MediaGroup (—ç–∫–æ–Ω–æ–º–∏—è 4 API –∑–∞–ø—Ä–æ—Å–æ–≤)
2. ‚úÖ 12 —Ñ–æ—Ç–æ ‚Üí 2 MediaGroups (—ç–∫–æ–Ω–æ–º–∏—è 10 API –∑–∞–ø—Ä–æ—Å–æ–≤)
3. ‚úÖ –°–º–µ—à–∞–Ω–Ω—ã–µ –º–µ–¥–∏–∞ ‚Üí –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ñ–æ—Ç–æ

## üéØ –ö–ª—é—á–µ–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:

```javascript
// –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Ñ–æ—Ç–æ –ø–æ MAX_MEDIA_GROUP_SIZE (10)
var photoGroups = [];
for (var i = 0; i < photos.length; i += MAX_MEDIA_GROUP_SIZE) {
  photoGroups.push(photos.slice(i, i + MAX_MEDIA_GROUP_SIZE));
}

// –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –û–î–ù–ò–ú –∑–∞–ø—Ä–æ—Å–æ–º
photoGroups.forEach(function(group, index) {
  var groupCaption = (index === 0) ? caption : null;
  sendTelegramMediaGroup(botToken, chatId, group, groupCaption, options);
});
```

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç:

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** 
–§—É–Ω–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ server.gs, –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã.

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–ª—è –≤—Å–µ—Ö VK –ø–æ—Å—Ç–æ–≤ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏!