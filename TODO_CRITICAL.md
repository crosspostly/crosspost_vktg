## üö´ –ö–†–ò–¢–ò–ß–ù–û #12: VK –í–ò–î–ï–û ‚Äî –ü–†–Ø–ú–´–ï –§–ê–ô–õ–´, –ù–ï EMBED

–ü—Ä–æ–±–ª–µ–º–∞:
- –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å—Å—ã–ª–∫–∏ –≤–∏–¥–∞ `video_ext.php` –≤–º–µ—Å—Ç–æ –ø—Ä—è–º—ã—Ö —Ñ–∞–π–ª–æ–≤
- –ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø—Ä—è–º–æ–≥–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ

–†–µ—à–µ–Ω–∏–µ (SERVER.gs):
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å VK API `video.get`/`video.get?videos={owner_id}_{video_id}` —Å User Token
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∫–∞—á–µ—Å—Ç–≤–∞: `files.mp4_720` ‚Üí `files.mp4_480` ‚Üí `files.mp4_360` ‚Üí `files.hls` (–∫–∞–∫ –∫—Ä–∞–π–Ω–∏–π —Å–ª—É—á–∞–π) [138]
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ Telegram –∫–∞–∫ –≤–∏–¥–µ–æ-—Ñ–∞–π–ª —á–µ—Ä–µ–∑ `sendVideo` (multipart –∏–ª–∏ –ø–æ –ø—Ä—è–º–æ–º—É URL, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω) [157][148]
- Fallback: –µ—Å–ª–∏ `files.*` –Ω–µ—Ç ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å player URL –∫–∞–∫ —Å—Å—ã–ª–∫—É
- –ù–ò–ö–ê–ö–û–ì–û HTML-–ø–∞—Ä—Å–∏–Ω–≥–∞ ‚Äî —Ç–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç VK API `video.get`

–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:
- VK API:
  - GET `https://api.vk.com/method/video.get?v=5.131&access_token=<USER_TOKEN>&videos=-22822305_456242110`
  - –û–∂–∏–¥–∞–µ–º –ø–æ–ª—è `files.mp4_720`, `files.mp4_480`, `files.mp4_360` –≤ –æ—Ç–≤–µ—Ç–µ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã) [138]
- Telegram API:
  - POST `https://api.telegram.org/bot<token>/sendVideo` —Å –ø–æ–ª—è–º–∏ `chat_id`, `video` (URL —Ñ–∞–π–ª–∞ –∏–ª–∏ multipart), `caption`, `supports_streaming=true` [157][151]

–ó–∞–º–µ—á–∞–Ω–∏—è –ø–æ Apps Script:
- –î–ª—è multipart –≤ GAS —Ñ–æ—Ä–º–∏—Ä—É–π —Ç–µ–ª–æ –≤—Ä—É—á–Ω—É—é —Å boundary –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π –ø—Ä—è–º–æ–π URL (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤) [152]
- –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø–æ URL Telegram –º–æ–∂–µ—Ç –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–∏–ø–æ–≤; –Ω–∞–¥—ë–∂–Ω–µ–µ multipart –¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ [148]

–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ (SERVER.gs):
- –§—É–Ω–∫—Ü–∏—è `getVkVideoDirectUrl(videoId)`:
  - –≤—ã–∑–≤–∞—Ç—å `video.get?videos={videoId}`
  - –≤—ã–±—Ä–∞—Ç—å –ø–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –∏–∑ `files.mp4_720`, `mp4_480`, `mp4_360`
  - –≤–µ—Ä–Ω—É—Ç—å –ø—Ä—è–º–æ–π URL –∏–ª–∏ `null`
- –í `sendVkPostToTelegram`:
  - –µ—Å–ª–∏ –µ—Å—Ç—å –æ–¥–Ω–æ –≤–∏–¥–µ–æ –∏ —Ç–µ–∫—Å—Ç: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å `sendVideo` —Å `caption`
  - –µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∏–¥–µ–æ ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ –æ–¥–Ω–æ–º—É (MediaGroup —É Telegram –Ω–µ –≤—Å–µ–≥–¥–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–º–µ—à–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å caption)

---

## üö´ –ö–†–ò–¢–ò–ß–ù–û #13: –ú–ï–î–ò–ê–ì–†–£–ü–ü–´ –ò –°–ú–ï–®–ê–ù–ù–´–ô –ö–û–ù–¢–ï–ù–¢

–ü—Ä–æ–±–ª–µ–º–∞:
- –§–æ—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–æ –æ–¥–Ω–æ–º—É
- –°–º–µ—à–∞–Ω–Ω—ã–µ –≤–ª–æ–∂–µ–Ω–∏—è —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ –º–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π

–†–µ—à–µ–Ω–∏–µ (SERVER.gs): —Å—Ç—Ä–∞—Ç–µ–≥–∏—è ¬´–º–∏–Ω–∏–º—É–º —Å–æ–æ–±—â–µ–Ω–∏–π¬ª —Å —É—á—ë—Ç–æ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π Telegram:
- –¢–æ–ª—å–∫–æ —Ñ–æ—Ç–æ ‚Üí `sendMediaGroup` (–¥–æ 10), `caption` —É –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ [135]
- –¢–æ–ª—å–∫–æ –≤–∏–¥–µ–æ ‚Üí –æ–¥–Ω–æ `sendVideo` —Å `caption` [157]
- –§–æ—Ç–æ + –≤–∏–¥–µ–æ ‚Üí
  - –µ—Å–ª–∏ 1 –≤–∏–¥–µ–æ + ‚â§9 —Ñ–æ—Ç–æ: —Å–Ω–∞—á–∞–ª–∞ `sendVideo` —Å `caption`, –∑–∞—Ç–µ–º `sendMediaGroup` c —Ñ–æ—Ç–æ –±–µ–∑ caption
  - –µ—Å–ª–∏ >1 –≤–∏–¥–µ–æ: –∫–∞–∂–¥–æ–µ –≤–∏–¥–µ–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º `sendVideo`, —Ñ–æ—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–æ–π
- –î–æ–∫—É–º–µ–Ω—Ç—ã –∏ –∞—É–¥–∏–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ (`sendDocument`, `sendAudio`) [144]

–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ (SERVER.gs):
- –í `getVkMediaUrls()` –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ä–∞–∑–¥–µ–ª—å–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã: `photos[]`, `videos[]` (—Å direct URLs —á–µ—Ä–µ–∑ `getVkVideoDirectUrl`), `docLinks[]`, `audioLinks[]`.
- –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `sendMixedMediaOptimized(botToken, chatId, media, caption)`:
  - –≤–µ—Ç–≤–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º –≤–ª–æ–∂–µ–Ω–∏–π
  - `sendMediaGroup` –¥–ª—è —Ñ–æ—Ç–æ –ø–∞—á–∫–æ–π
  - `sendVideo` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∏–¥–µ–æ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ direct URL), –∏–Ω–∞—á–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫–æ–π
  - –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –º–∞—Å—Å–∏–≤ message_id –∏ –æ—à–∏–±–∫–∏

–ü—Ä–∏–º–µ—Ä—ã:
- –§–æ—Ç–æ x6: 1 –∑–∞–ø—Ä–æ—Å `sendMediaGroup` (caption –≤ –ø–µ—Ä–≤–æ–º) [135]
- –í–∏–¥–µ–æ x1 + –§–æ—Ç–æ x4: 1 `sendVideo` (caption) + 1 `sendMediaGroup` (–±–µ–∑ caption)
- –í–∏–¥–µ–æ x3 + –§–æ—Ç–æ x5: 3 `sendVideo` + 1 `sendMediaGroup`

---

## üßπ –ß–ò–°–¢–ö–ê –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–ò/–ü–ê–¢–ß–ï–ô
- –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –¥—É–±–ª–∏ ¬´–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è¬ª –≤ –æ–¥–∏–Ω —Ñ–∞–π–ª: `docs/ARCHITECTURE.md`
- –û—Å—Ç–∞–≤–∏—Ç—å –æ–¥–∏–Ω –∞–∫—Ç—É–∞–ª—å–Ω—ã–π TODO: `TODO.md` (—ç—Ç–æ—Ç)
- –ü–∞–ø–∫–∏ `—Å–µ—Ä–≤–µ—Ä_–ø–∞—Ç—á` –∏ `–∫–ª–∏–µ–Ω—Ç_–ø–∞—Ç—á` –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ `patches/` –∏ —É–¥–∞–ª–∏—Ç—å –¥—É–±–ª—è–∂–∏

---

## üìå –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫–∏ –∏ –ø—Ä–∞–∫—Ç–∏–∫–∏
- VK API `video.get` ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫–∞ (–ø–æ–ª—è –æ—Ç–≤–µ—Ç–∞, –≤ —Ç. —á. `files.*`) [138]
- Telegram Bot API `sendVideo`, `sendMediaGroup` ‚Äî –ª–∏–º–∏—Ç—ã –∏ —Ñ–æ—Ä–º–∞—Ç—ã [157][135]
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ URL –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ multipart [148]
- Multipart –≤ Google Apps Script (–ø—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏) [152]
