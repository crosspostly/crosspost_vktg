# Binding Sheets Migration Guide

## üéØ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –î–æ (OLD)
```
–ò–º—è —Å–≤—è–∑–∫–∏: "My VK Group"
–õ–∏—Å—Ç –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–π: "Published_MyVKGroup" 
–ü—Ä–æ–±–ª–µ–º–∞: –ò–º—è –ª–∏—Å—Ç–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç bindingName
```

### –ü–æ—Å–ª–µ (NEW)
```
–ò–º—è —Å–≤—è–∑–∫–∏: "MyVKGroup" (—Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã)
–õ–∏—Å—Ç –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–π: "MyVKGroup" (—Ç–æ—á–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ)
–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ: –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã
```

## üìã –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∏—Å—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–π

### –ó–∞–≥–æ–ª–æ–≤–∫–∏ (Row 1)
```
timestamp | status | vkGroupId | vkPostId | vkPostUrl | vkPostDate | mediaSummary | captionChars | captionParts | tgChat | tgMessageIds | tgMessageUrls | notes
```

### –û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---------|-----|----------|--------|
| `timestamp` | ISO 8601 | –í—Ä–µ–º—è –ø–æ–ø—ã—Ç–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ | `2025-01-15T10:30:45.123Z` |
| `status` | string | `success` / `partial` / `error` | `success` |
| `vkGroupId` | string | ID –≥—Ä—É–ø–ø—ã VK | `-123456789` |
| `vkPostId` | string | ID –ø–æ—Å—Ç–∞ VK | `987654` |
| `vkPostUrl` | string | –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ—Å—Ç VK | `https://vk.com/wall-123456789_987654` |
| `vkPostDate` | ISO 8601 | –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ—Å—Ç–∞ VK | `2025-01-15T09:00:00.000Z` |
| `mediaSummary` | string | –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ –º–µ–¥–∏–∞ | `3 photos, 1 video` |
| `captionChars` | number | –°–∏–º–≤–æ–ª–æ–≤ –≤ –ø–æ–¥–ø–∏—Å–∏ | `250` |
| `captionParts` | number | –ß–∞—Å—Ç–µ–π —Å–æ–æ–±—â–µ–Ω–∏—è | `1` |
| `tgChat` | string | ID –∏–ª–∏ username TG —á–∞—Ç–∞ | `@mychannel` |
| `tgMessageIds` | string | ID —Å–æ–æ–±—â–µ–Ω–∏–π TG (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é) | `12345,12346` |
| `tgMessageUrls` | string | –°—Å—ã–ª–∫–∏ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è TG | `https://t.me/mychannel/12345, https://t.me/mychannel/12346` |
| `notes` | string | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ | `Successfully sent all media` |

### –í–∞–∂–Ω–æ: Row 2 = –ø–æ—Å–ª–µ–¥–Ω—è—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è
–ù–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –≤—Å–µ–≥–¥–∞ –≤—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ —Å—Ç—Ä–æ–∫—É 2 (—Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞), –ø–æ—ç—Ç–æ–º—É —Å–∞–º–∞—è —Å–≤–µ–∂–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤—Å–µ–≥–¥–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞–≤–µ—Ä—Ö—É.

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

1. **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–≤—è–∑–∫–∏** (`buildBindingObjectFromRow`):
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è `bindingName` –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ 10
   - –ò–º—è –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è: `sanitizeBindingSheetSuffix(bindingName)`
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `migrateLegacyBindingSheets()` –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–∏—Å—Ç–æ–≤

2. **–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–ø–æ–ª—É—á–µ–Ω–∏–∏ –ª–∏—Å—Ç–∞** (`getOrCreateBindingSheet`):
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ —Å –Ω–æ–≤—ã–º –∏–º–µ–Ω–µ–º
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω –ª–∏—Å—Ç —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `Published_*`, –æ–Ω –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è
   - –ï—Å–ª–∏ –ª–∏—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏

3. **–ö–∞–Ω–¥–∏–¥–∞—Ç—ã –Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—é**:
   - `Published_<oldName>` (—Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º)
   - `<oldName>` (–µ—Å–ª–∏ –∏–º—è –∏–∑–º–µ–Ω–∏–ª–æ—Å—å)
   - –í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–∏–º–µ—Ä –º–∏–≥—Ä–∞—Ü–∏–∏

```javascript
// –ë—ã–ª–æ:
Binding Name –≤ –ë–î: "My Cool Group!"
–õ–∏—Å—Ç: "Published_MyCoolGroup"

// –°—Ç–∞–ª–æ:
Binding Name –≤ –ë–î: "MyCoolGroup" (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –ø—Ä–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏)
–õ–∏—Å—Ç: "MyCoolGroup" (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω)
```

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### 1. –ó–∞–ø–∏—Å—å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (–ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ—Å—Ç–∞)

```javascript
// –î–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø–∏—Å–∏
var publicationData = {
  status: 'success',              // –∏–ª–∏ 'partial', 'error'
  vkGroupId: '-123456789',
  vkPostId: '987654',
  vkPostUrl: 'https://vk.com/wall-123456789_987654',
  vkPostDate: new Date().toISOString(),
  mediaSummary: '3 photos, 1 video',
  captionChars: 250,
  captionParts: 1,
  tgChat: '@mychannel',
  tgMessageIds: '12345,12346',
  tgMessageUrls: 'https://t.me/mychannel/12345, https://t.me/mychannel/12346',
  notes: 'Successfully sent all media'
};

// –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ –ª–∏—Å—Ç —Å–≤—è–∑–∫–∏
writePublicationRowToBindingSheet(binding.bindingName, publicationData);
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏

```javascript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ –ø–æ—Å—Ç —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
var alreadySent = checkPostAlreadySent(binding.bindingName, vkPostId);

if (alreadySent) {
  // –ü–æ—Å—Ç —É–∂–µ –±—ã–ª —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω (status = success –∏–ª–∏ partial)
  return;
}

// –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ—Å—Ç...
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ ID –ø–æ—Å—Ç–∞

```javascript
// –ü–æ–ª—É—á–∞–µ–º ID –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞
var lastPostId = getLastPostIdFromSheet(binding.bindingName, vkGroupId);

// lastPostId = '987654' –∏–ª–∏ null (–µ—Å–ª–∏ –ø–æ—Å—Ç–æ–≤ –µ—â–µ –Ω–µ –±—ã–ª–æ)
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

–ò–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏:
1. –û—Ç–∫—Ä—ã—Ç—å "üéõÔ∏è –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å"
2. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å—å —Å—Ç—Ä–æ–∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏"

–ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ:
```javascript
var result = testPublicationRowWrites();
console.log(result);
```

### –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è

1. **Success case**: –ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
2. **Partial case**: –ó–∞–ø–∏—Å—å —á–∞—Å—Ç–∏—á–Ω–æ —É—Å–ø–µ—à–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
3. **Error case**: –ó–∞–ø–∏—Å—å –Ω–µ—É–¥–∞—á–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
4. **Invalid name**: –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∏–º–µ–Ω–∞ –Ω–µ —Å–æ–∑–¥–∞—é—Ç –ª–∏—Å—Ç—ã

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```javascript
{
  success: true,
  message: "Publication row write tests completed",
  testBindingName: "TestBinding123",
  testsRun: ["success", "partial", "error", "invalid_name"]
}
```

–ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏—Å—Ç **TestBinding123** –≤ –≤–∞—à–µ–π —Ç–∞–±–ª–∏—Ü–µ.

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω —Å–≤—è–∑–æ–∫

**–†–∞–∑—Ä–µ—à–µ–Ω—ã**: —Ç–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã (a-z, A-Z), –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ –±—É–∫–≤—ã (–∞-—è, –ê-–Ø), —Ü–∏—Ñ—Ä—ã (0-9)

**–ó–∞–ø—Ä–µ—â–µ–Ω—ã**: –ø—Ä–æ–±–µ–ª—ã, –¥–µ—Ñ–∏—Å—ã, –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏—è, —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã

```javascript
validateBindingName("MyGroup123")     // ‚úÖ true
validateBindingName("–ú–æ—è–ì—Ä—É–ø–ø–∞456")   // ‚úÖ true
validateBindingName("My-Group")       // ‚ùå false (–¥–µ—Ñ–∏—Å)
validateBindingName("My Group")       // ‚ùå false (–ø—Ä–æ–±–µ–ª)
validateBindingName("My_Group")       // ‚ùå false (–ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏–µ)
```

### –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–≤—è–∑–∫–∏

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–≤—è–∑–∫–∏ –∏–º—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è:

```javascript
// –í–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
binding_name: "My Cool Group!!!"

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ –ë–î –ø–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
bindingName: "MyCoolGroup"

// –ò–º—è –ª–∏—Å—Ç–∞
Sheet: "MyCoolGroup"
```

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–í—Å–µ —Å—Ç–∞—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–æ —Ç–µ–ø–µ—Ä—å –¥–µ–ª–µ–≥–∏—Ä—É—é—Ç –ª–æ–≥–∏–∫—É –Ω–æ–≤—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º:

- `createPublishedSheet()` ‚Üí —Å–æ–∑–¥–∞–µ—Ç –ª–∏—Å—Ç —Å –∏–º–µ–Ω–µ–º bindingName
- `saveLastPostIdToSheet()` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–ª–æ–Ω–æ–∫
- `getLastPostIdFromSheet()` ‚Üí —á–∏—Ç–∞–µ—Ç –∏–∑ –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
- `checkPostAlreadySent()` ‚Üí —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ success/partial

## üìä –°—Ç–∞—Ç—É—Å—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–π

### success
- –í—Å–µ —á–∞—Å—Ç–∏ –ø–æ—Å—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- –í—Å–µ media groups –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã
- –í–µ—Å—å —Ç–µ–∫—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω

### partial
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–∏ –ø–æ—Å—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ media groups –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏—Å—å
- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–æ—Å—Ç–∞–≤–ª–µ–Ω, –Ω–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã

### error
- –ù–∏ –æ–¥–Ω–∞ —á–∞—Å—Ç—å –ø–æ—Å—Ç–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å

## üîó –ì–µ–Ω–µ—Ä–∞—Ü–∏—è TG —Å—Å—ã–ª–æ–∫

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: Username
–ï—Å–ª–∏ —É –∫–∞–Ω–∞–ª–∞/–≥—Ä—É–ø–ø—ã –µ—Å—Ç—å username:
```
https://t.me/mychannel/12345
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: Internal ID
–ï—Å–ª–∏ username –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–∞–Ω–∞–ª/–≥—Ä—É–ø–ø–∞):
```
https://t.me/c/1234567890/12345
```

–ì–¥–µ `1234567890` = chat_id –±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–∞ `-100`

## üìù –ü—Ä–∏–º–µ—Ä—ã use-cases

### Case 1: –ü–µ—Ä–≤–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ –Ω–æ–≤—É—é —Å–≤—è–∑–∫—É

```javascript
// –°–≤—è–∑–∫–∞ —Å–æ–∑–¥–∞–Ω–∞, –ø–æ—Å—Ç–∞ –µ—â–µ –Ω–µ –±—ã–ª–æ
var lastPost = getLastPostIdFromSheet("MyGroup", "-123"); 
// ‚Üí null

// –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ—Å—Ç
sendVkPostToTelegram(chatId, vkPost, binding);
// ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ª–∏—Å—Ç "MyGroup" —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
// ‚Üí –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ –≤ Row 2 —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º success
```

### Case 2: –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–æ–≥–æ –∂–µ –ø–æ—Å—Ç–∞

```javascript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—é
var sent = checkPostAlreadySent("MyGroup", "987654");
// ‚Üí true (–Ω–∞–π–¥–µ–Ω–∞ –∑–∞–ø–∏—Å—å —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º success –≤ Row 2)

// –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É
if (sent) {
  logEvent("DEBUG", "post_already_sent", ...);
  return;
}
```

### Case 3: –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ —Å—Ç–∞—Ä—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º

```javascript
// –í —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å –ª–∏—Å—Ç "Published_OldGroup"
// –í –∫–æ–ª–æ–Ω–∫–µ Binding Name –∑–∞–ø–∏—Å–∞–Ω–æ "Old Group"

// –ü—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Å–≤—è–∑–∫–∏:
buildBindingObjectFromRow(row)
// ‚Üí –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∏–º—è: "OldGroup"
// ‚Üí –í—ã–∑—ã–≤–∞–µ—Ç migrateLegacyBindingSheets()
// ‚Üí –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç "Published_OldGroup" ‚Üí "OldGroup"

// –¢–µ–ø–µ—Ä—å –ª–∏—Å—Ç –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ "OldGroup"
```

## üöÄ –ß—Ç–æ –¥–∞–ª—å—à–µ

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ `binding_sheet_migrated` –∏ `binding_sheet_promoted`
2. **–û—á–∏—Å—Ç–∫–∞**: –°—Ç–∞—Ä—ã–µ –ª–∏—Å—Ç—ã `Published_*` –¥–æ–ª–∂–Ω—ã –∏—Å—á–µ–∑–Ω—É—Ç—å –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–æ—Å—Ç—ã –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è)
4. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–µ –ø–æ–ª—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–π

## üí° –°–æ–≤–µ—Ç—ã

- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `sanitizeBindingSheetSuffix()` –ø–µ—Ä–µ–¥ —Ä–∞–±–æ—Ç–æ–π —Å –∏–º–µ–Ω–∞–º–∏ –ª–∏—Å—Ç–æ–≤
- –õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–∏–≥—Ä–∞—Ü–∏—è—Ö –∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ª–∏—Å—Ç–æ–≤
- –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –º–∏–≥—Ä–∞—Ü–∏–µ–π –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–æ–≤
- –¢–µ—Å—Ç–æ–≤—ã–π –ª–∏—Å—Ç `TestBinding123` –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤
